{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"strictMode/","text":"StrictMode\u7c7b\u662fAndroid 2.3 \uff08API 9\uff09\u5f15\u5165\u7684\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u53ef\u4ee5\u7528\u6765\u5e2e\u52a9\u5f00\u53d1\u8005\u53d1\u73b0\u4ee3\u7801\u4e2d\u7684\u4e00\u4e9b\u4e0d\u89c4\u8303\u7684\u95ee\u9898\uff0c\u4ee5\u8fbe\u5230\u63d0\u5347\u5e94\u7528\u54cd\u5e94\u80fd\u529b\u7684\u76ee\u7684\u3002 \u4e25\u82db\u6a21\u5f0f\u4e3b\u8981\u67092\u5927\u68c0\u6d4b\u7b56\u7565\uff0c\u4e00\u4e2a\u662f\u7ebf\u7a0b\u7b56\u7565\uff0c\u5373TreadPolicy\uff0c\u53e6\u4e00\u4e2a\u662fVM\u7b56\u7565\uff0c\u5373VmPolicy\u3002 ThreadPolicy\u7ebf\u7a0b\u7b56\u7565\u68c0\u6d4b \u81ea\u5b9a\u4e49\u7684\u8017\u65f6\u8c03\u7528 \u4f7f\u7528detectCustomSlowCalls()\u5f00\u542f\uff0c\u9488\u5bf9\u6267\u884c\u6bd4\u8f83\u8017\u65f6\u7684\u68c0\u67e5 \u78c1\u76d8\u8bfb\u53d6\u64cd\u4f5c \u4f7f\u7528detectDiskReads()\u5f00\u542f\uff0c\u7528\u4e8e\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u4e2d\u662f\u5426\u6709\u78c1\u76d8\u8bfb\u53d6\u64cd\u4f5c \u78c1\u76d8\u5199\u5165\u64cd\u4f5c \u4f7f\u7528detectDiskWrites()\u5f00\u542f\uff0c\u7528\u4e8e\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u4e2d\u662f\u5426\u6709\u78c1\u76d8\u5199\u5165\u64cd\u4f5c \u7f51\u7edc\u64cd\u4f5c \u4f7f\u7528detectNetwork()\u5f00\u542f\uff0c\u7528\u4e8e\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u4e2d\u662f\u5426\u6709\u7f51\u7edc\u8bf7\u6c42\u64cd\u4f5c ThreadPolicy\u5728\u54ea\u4e2a\u7ebf\u7a0b\u8bbe\u7f6e\u8fc7\uff0c\u5c31\u5728\u54ea\u4e2a\u7ebf\u7a0b\u68c0\u6d4b\u3002 boolean DEV_MODE = true; public void onCreate() { if (DEV_MODE) { StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder() .detectCustomSlowCalls() //API\u7b49\u7ea711\uff0c\u4f7f\u7528StrictMode.noteSlowCode .detectDiskReads() .detectDiskWrites() .detectNetwork() .penaltyDialog() //\u5f39\u51fa\u8fdd\u89c4\u63d0\u793a\u5bf9\u8bdd\u6846 .penaltyLog() //\u5728Logcat\u4e2d\u6253\u5370\u8fdd\u89c4\u5f02\u5e38\u4fe1\u606f .penaltyFlashScreen() //\u5c4f\u5e55\u95ea\u70c1 .build()) } super.onCreate() } \u81ea\u5b9a\u4e49\u8017\u65f6\u68c0\u67e5\uff0c\u8c03\u7528StrictMode.noteSlowCall public class TaskExecutor { private static long SLOW_CALL_THRESHOLD = 500; public void executeTask(Runnable task) { long startTime = SystemClock.uptimeMillis(); task.run(); long cost = SystemClock.uptimeMillis() - startTime; if (cost > SLOW_CALL_THRESHOLD) { StrictMode.noteSlowCall(\"slowCall cost=\" + cost); } } } penaltyDeath()\uff0c\u5f53\u89e6\u53d1\u8fdd\u89c4\u6761\u4ef6\u65f6\uff0c\u76f4\u63a5Crash\u6389\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u3002 penaltyDeathOnNetwork()\uff0c\u5f53\u89e6\u53d1\u7f51\u7edc\u8fdd\u89c4\u65f6\uff0cCrash\u6389\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u3002 penaltyDialog()\uff0c\u89e6\u53d1\u8fdd\u89c4\u65f6\uff0c\u663e\u793a\u5bf9\u8fdd\u89c4\u4fe1\u606f\u5bf9\u8bdd\u6846\u3002 penaltyFlashScreen()\uff0c\u4f1a\u9020\u6210\u5c4f\u5e55\u95ea\u70c1\uff0c\u4e0d\u8fc7\u4e00\u822c\u7684\u8bbe\u5907\u53ef\u80fd\u6ca1\u6709\u8fd9\u4e2a\u529f\u80fd\u3002 penaltyDropBox()\uff0c\u5c06\u8fdd\u89c4\u4fe1\u606f\u8bb0\u5f55\u5230 dropbox \u7cfb\u7edf\u65e5\u5fd7\u76ee\u5f55\u4e2d\uff08/data/system/dropbox\uff09\u3002 permitCustomSlowCalls()\u3001permitDiskReads ()\u3001permitDiskWrites()\u3001permitNetwork \u5982\u679c\u4f60\u60f3\u5173\u95ed\u67d0\u4e00\u9879\u68c0\u6d4b\uff0c\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684permit*\u65b9\u6cd5\u3002 VmPolicy\u865a\u62df\u673a\u7b56\u7565\u68c0\u6d4b \u68c0\u67e5 Activity \u7684\u5185\u5b58\u6cc4\u9732\u60c5\u51b5 \u4f7f\u7528detectActivityLeaks()\u5f00\u542f \u68c0\u67e5\u8d44\u6e90\u6ca1\u6709\u6b63\u786e\u5173\u95ed\u65f6\u63d0\u9192 \u4f7f\u7528detectLeakedClosableObjects()\u5f00\u542f \u6cc4\u9732\u7684Sqlite\u5bf9\u8c61 \u4f7f\u7528detectLeakedSqlLiteObjects()\u5f00\u542f \u6ce8\u518c\u7c7b\u5bf9\u8c61\u662f\u5426\u88ab\u6b63\u786e\u91ca\u653e\uff0c\u5982BroadcastReceiver \u6216 ServiceConnection\uff0c\u4f7f\u7528detectLeakedRegistrationObjects()\u5f00\u542f \u68c0\u6d4b\u5b9e\u4f8b\u6570\u91cf\uff0c\u53ef\u4ee5\u534f\u52a9\u68c0\u67e5\u5185\u5b58\u6cc4\u9732\uff0c\u4f7f\u7528setClassInstanceLimit()\u5f00\u542f boolean DEV_MODE = true; public void onCreate() { if (DEV_MODE) { StrictMode.setVmPolicy(new StrictMode.VmPolicy.Builder() .detectLeakedSqlLiteObjects() .detectLeakedClosableObjects() //API\u7b49\u7ea711 .penaltyLog() .penaltyDeath() .build()) } super.onCreate() } \u539f\u7406 StrictMode\u5b9e\u73b0\u539f\u7406\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u5728\u76f8\u5173\u7684\u4ee3\u7801\u70b9\u63d2\u5165\u68c0\u6d4b\u4ee3\u7801\uff0c\u6839\u636e\u7b56\u7565\u505a\u68c0\u67e5\u3002 \u4ee5IO\u64cd\u4f5c\u4e3a\u4f8b\uff0c\u4e3b\u8981\u662f\u901a\u8fc7\u5728open\uff0cread\uff0cwrite\uff0cclose\u65f6\u8fdb\u884c\u76d1\u63a7\u3002libcore.io.BlockGuardOs\u6587\u4ef6\u5c31\u662f\u76d1\u63a7\u7684\u5730\u65b9\u3002 \u4ee5write\u4e3a\u4f8b\uff0c\u5982\u4e0b\u8fdb\u884c\u76d1\u63a7\uff1a @Override public int pwrite(FileDescriptor fd, ByteBuffer buffer, long offset) { BlockGuard.getThreadPolicy().onWriteToDisk(); return os.pwrite(fd, buffer, offset); } \u5176\u4e2donReadFromDisk()\u65b9\u6cd5\u7684\u5b9e\u73b0\uff0c\u4ee3\u7801\u4f4d\u4e8eStrictMode.java\u4e2d // Part of BlockGuard.Policy interface: public void onReadFromDisk() { if ((mPolicyMask & DETECT_DISK_READ) == 0) { return; } if (tooManyViolationsThisLoop()) { return; } startHandlingViolationException(new DiskReadViolation()); } \u6ce8\u610f\u4e8b\u9879 \u53ea\u5728\u5f00\u53d1\u9636\u6bb5\u542f\u7528StrictMode\uff0c\u53d1\u5e03\u5e94\u7528\u6216\u8005release\u7248\u672c\u4e00\u5b9a\u8981\u7981\u7528\u5b83\u3002 \u4e25\u683c\u6a21\u5f0f\u65e0\u6cd5\u76d1\u63a7JNI\u4e2d\u7684\u78c1\u76d8IO\u548c\u7f51\u7edc\u8bf7\u6c42\u3002 \u5e94\u7528\u4e2d\u5e76\u975e\u9700\u8981\u89e3\u51b3\u5168\u90e8\u7684\u8fdd\u4f8b\u60c5\u51b5\uff0c\u6bd4\u5982\u6709\u4e9bIO\u64cd\u4f5c\u5fc5\u987b\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u8fdb\u884c\u3002","title":"Android StictMode"},{"location":"strictMode/#threadpolicy","text":"\u81ea\u5b9a\u4e49\u7684\u8017\u65f6\u8c03\u7528 \u4f7f\u7528detectCustomSlowCalls()\u5f00\u542f\uff0c\u9488\u5bf9\u6267\u884c\u6bd4\u8f83\u8017\u65f6\u7684\u68c0\u67e5 \u78c1\u76d8\u8bfb\u53d6\u64cd\u4f5c \u4f7f\u7528detectDiskReads()\u5f00\u542f\uff0c\u7528\u4e8e\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u4e2d\u662f\u5426\u6709\u78c1\u76d8\u8bfb\u53d6\u64cd\u4f5c \u78c1\u76d8\u5199\u5165\u64cd\u4f5c \u4f7f\u7528detectDiskWrites()\u5f00\u542f\uff0c\u7528\u4e8e\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u4e2d\u662f\u5426\u6709\u78c1\u76d8\u5199\u5165\u64cd\u4f5c \u7f51\u7edc\u64cd\u4f5c \u4f7f\u7528detectNetwork()\u5f00\u542f\uff0c\u7528\u4e8e\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u4e2d\u662f\u5426\u6709\u7f51\u7edc\u8bf7\u6c42\u64cd\u4f5c ThreadPolicy\u5728\u54ea\u4e2a\u7ebf\u7a0b\u8bbe\u7f6e\u8fc7\uff0c\u5c31\u5728\u54ea\u4e2a\u7ebf\u7a0b\u68c0\u6d4b\u3002 boolean DEV_MODE = true; public void onCreate() { if (DEV_MODE) { StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder() .detectCustomSlowCalls() //API\u7b49\u7ea711\uff0c\u4f7f\u7528StrictMode.noteSlowCode .detectDiskReads() .detectDiskWrites() .detectNetwork() .penaltyDialog() //\u5f39\u51fa\u8fdd\u89c4\u63d0\u793a\u5bf9\u8bdd\u6846 .penaltyLog() //\u5728Logcat\u4e2d\u6253\u5370\u8fdd\u89c4\u5f02\u5e38\u4fe1\u606f .penaltyFlashScreen() //\u5c4f\u5e55\u95ea\u70c1 .build()) } super.onCreate() } \u81ea\u5b9a\u4e49\u8017\u65f6\u68c0\u67e5\uff0c\u8c03\u7528StrictMode.noteSlowCall public class TaskExecutor { private static long SLOW_CALL_THRESHOLD = 500; public void executeTask(Runnable task) { long startTime = SystemClock.uptimeMillis(); task.run(); long cost = SystemClock.uptimeMillis() - startTime; if (cost > SLOW_CALL_THRESHOLD) { StrictMode.noteSlowCall(\"slowCall cost=\" + cost); } } } penaltyDeath()\uff0c\u5f53\u89e6\u53d1\u8fdd\u89c4\u6761\u4ef6\u65f6\uff0c\u76f4\u63a5Crash\u6389\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u3002 penaltyDeathOnNetwork()\uff0c\u5f53\u89e6\u53d1\u7f51\u7edc\u8fdd\u89c4\u65f6\uff0cCrash\u6389\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u3002 penaltyDialog()\uff0c\u89e6\u53d1\u8fdd\u89c4\u65f6\uff0c\u663e\u793a\u5bf9\u8fdd\u89c4\u4fe1\u606f\u5bf9\u8bdd\u6846\u3002 penaltyFlashScreen()\uff0c\u4f1a\u9020\u6210\u5c4f\u5e55\u95ea\u70c1\uff0c\u4e0d\u8fc7\u4e00\u822c\u7684\u8bbe\u5907\u53ef\u80fd\u6ca1\u6709\u8fd9\u4e2a\u529f\u80fd\u3002 penaltyDropBox()\uff0c\u5c06\u8fdd\u89c4\u4fe1\u606f\u8bb0\u5f55\u5230 dropbox \u7cfb\u7edf\u65e5\u5fd7\u76ee\u5f55\u4e2d\uff08/data/system/dropbox\uff09\u3002 permitCustomSlowCalls()\u3001permitDiskReads ()\u3001permitDiskWrites()\u3001permitNetwork \u5982\u679c\u4f60\u60f3\u5173\u95ed\u67d0\u4e00\u9879\u68c0\u6d4b\uff0c\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684permit*\u65b9\u6cd5\u3002","title":"ThreadPolicy\u7ebf\u7a0b\u7b56\u7565\u68c0\u6d4b"},{"location":"strictMode/#vmpolicy","text":"\u68c0\u67e5 Activity \u7684\u5185\u5b58\u6cc4\u9732\u60c5\u51b5 \u4f7f\u7528detectActivityLeaks()\u5f00\u542f \u68c0\u67e5\u8d44\u6e90\u6ca1\u6709\u6b63\u786e\u5173\u95ed\u65f6\u63d0\u9192 \u4f7f\u7528detectLeakedClosableObjects()\u5f00\u542f \u6cc4\u9732\u7684Sqlite\u5bf9\u8c61 \u4f7f\u7528detectLeakedSqlLiteObjects()\u5f00\u542f \u6ce8\u518c\u7c7b\u5bf9\u8c61\u662f\u5426\u88ab\u6b63\u786e\u91ca\u653e\uff0c\u5982BroadcastReceiver \u6216 ServiceConnection\uff0c\u4f7f\u7528detectLeakedRegistrationObjects()\u5f00\u542f \u68c0\u6d4b\u5b9e\u4f8b\u6570\u91cf\uff0c\u53ef\u4ee5\u534f\u52a9\u68c0\u67e5\u5185\u5b58\u6cc4\u9732\uff0c\u4f7f\u7528setClassInstanceLimit()\u5f00\u542f boolean DEV_MODE = true; public void onCreate() { if (DEV_MODE) { StrictMode.setVmPolicy(new StrictMode.VmPolicy.Builder() .detectLeakedSqlLiteObjects() .detectLeakedClosableObjects() //API\u7b49\u7ea711 .penaltyLog() .penaltyDeath() .build()) } super.onCreate() }","title":"VmPolicy\u865a\u62df\u673a\u7b56\u7565\u68c0\u6d4b"},{"location":"strictMode/#_1","text":"StrictMode\u5b9e\u73b0\u539f\u7406\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u5728\u76f8\u5173\u7684\u4ee3\u7801\u70b9\u63d2\u5165\u68c0\u6d4b\u4ee3\u7801\uff0c\u6839\u636e\u7b56\u7565\u505a\u68c0\u67e5\u3002 \u4ee5IO\u64cd\u4f5c\u4e3a\u4f8b\uff0c\u4e3b\u8981\u662f\u901a\u8fc7\u5728open\uff0cread\uff0cwrite\uff0cclose\u65f6\u8fdb\u884c\u76d1\u63a7\u3002libcore.io.BlockGuardOs\u6587\u4ef6\u5c31\u662f\u76d1\u63a7\u7684\u5730\u65b9\u3002 \u4ee5write\u4e3a\u4f8b\uff0c\u5982\u4e0b\u8fdb\u884c\u76d1\u63a7\uff1a @Override public int pwrite(FileDescriptor fd, ByteBuffer buffer, long offset) { BlockGuard.getThreadPolicy().onWriteToDisk(); return os.pwrite(fd, buffer, offset); } \u5176\u4e2donReadFromDisk()\u65b9\u6cd5\u7684\u5b9e\u73b0\uff0c\u4ee3\u7801\u4f4d\u4e8eStrictMode.java\u4e2d // Part of BlockGuard.Policy interface: public void onReadFromDisk() { if ((mPolicyMask & DETECT_DISK_READ) == 0) { return; } if (tooManyViolationsThisLoop()) { return; } startHandlingViolationException(new DiskReadViolation()); }","title":"\u539f\u7406"},{"location":"strictMode/#_2","text":"\u53ea\u5728\u5f00\u53d1\u9636\u6bb5\u542f\u7528StrictMode\uff0c\u53d1\u5e03\u5e94\u7528\u6216\u8005release\u7248\u672c\u4e00\u5b9a\u8981\u7981\u7528\u5b83\u3002 \u4e25\u683c\u6a21\u5f0f\u65e0\u6cd5\u76d1\u63a7JNI\u4e2d\u7684\u78c1\u76d8IO\u548c\u7f51\u7edc\u8bf7\u6c42\u3002 \u5e94\u7528\u4e2d\u5e76\u975e\u9700\u8981\u89e3\u51b3\u5168\u90e8\u7684\u8fdd\u4f8b\u60c5\u51b5\uff0c\u6bd4\u5982\u6709\u4e9bIO\u64cd\u4f5c\u5fc5\u987b\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u8fdb\u884c\u3002","title":"\u6ce8\u610f\u4e8b\u9879"}]}